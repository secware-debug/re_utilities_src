#include "dbghelp.h"
#include <filesystem>

HMODULE dbghelp_dll;

#define WRAPPER_FUNC(name) o##name = GetProcAddress(dbghelp_dll, ###name)

#ifdef _M_AMD64
#pragma warning (disable: 4081)
#define STRINGIFY(name) #name
#define EXPORT_FUNCTION comment(linker, "/EXPORT:" __FUNCTION__ "=" __FUNCDNAME__)
#define WRAPPER_GENFUNC(name) \
    FARPROC o##name; \
    __declspec(dllexport) void WINAPI _##name() \
    { \
        __pragma(STRINGIFY(EXPORT_FUNCTION)); \
        o##name(); \
    }
#else
#define WRAPPER_GENFUNC(name) \
	FARPROC o##name; \
	__declspec(naked) void _##name() \
	{ \
		__asm jmp[o##name] \
	}
#endif

WRAPPER_GENFUNC(_EFN_DumpImage);
WRAPPER_GENFUNC(block);
WRAPPER_GENFUNC(chksym);
WRAPPER_GENFUNC(dbghelp);
WRAPPER_GENFUNC(DbgHelpCreateUserDump);
WRAPPER_GENFUNC(DbgHelpCreateUserDumpW);
WRAPPER_GENFUNC(dh);
WRAPPER_GENFUNC(EnumDirTree);
WRAPPER_GENFUNC(EnumDirTreeW);
WRAPPER_GENFUNC(EnumerateLoadedModules);
WRAPPER_GENFUNC(EnumerateLoadedModules64);
WRAPPER_GENFUNC(EnumerateLoadedModulesEx);
WRAPPER_GENFUNC(EnumerateLoadedModulesExW);
WRAPPER_GENFUNC(EnumerateLoadedModulesW64);
WRAPPER_GENFUNC(ExtensionApiVersion);
WRAPPER_GENFUNC(FindDebugInfoFile);
WRAPPER_GENFUNC(FindDebugInfoFileEx);
WRAPPER_GENFUNC(FindDebugInfoFileExW);
WRAPPER_GENFUNC(FindExecutableImage);
WRAPPER_GENFUNC(FindExecutableImageEx);
WRAPPER_GENFUNC(FindExecutableImageExW);
WRAPPER_GENFUNC(FindFileInPath);
WRAPPER_GENFUNC(FindFileInSearchPath);
WRAPPER_GENFUNC(fptr);
WRAPPER_GENFUNC(GetSymLoadError);
WRAPPER_GENFUNC(GetTimestampForLoadedLibrary);
WRAPPER_GENFUNC(homedir);
WRAPPER_GENFUNC(ImageDirectoryEntryToData);
WRAPPER_GENFUNC(ImageDirectoryEntryToDataEx);
WRAPPER_GENFUNC(ImagehlpApiVersion);
WRAPPER_GENFUNC(ImagehlpApiVersionEx);
WRAPPER_GENFUNC(ImageNtHeader);
WRAPPER_GENFUNC(ImageRvaToSection);
WRAPPER_GENFUNC(ImageRvaToVa);
WRAPPER_GENFUNC(inlinedbg);
WRAPPER_GENFUNC(itoldyouso);
WRAPPER_GENFUNC(lmi);
WRAPPER_GENFUNC(lminfo);
WRAPPER_GENFUNC(MakeSureDirectoryPathExists);
WRAPPER_GENFUNC(MapDebugInformation);
WRAPPER_GENFUNC(MiniDumpReadDumpStream);
WRAPPER_GENFUNC(MiniDumpWriteDump);
WRAPPER_GENFUNC(omap);
WRAPPER_GENFUNC(optdbgdump);
WRAPPER_GENFUNC(optdbgdumpaddr);
WRAPPER_GENFUNC(RangeMapAddPeImageSections);
WRAPPER_GENFUNC(RangeMapCreate);
WRAPPER_GENFUNC(RangeMapFree);
WRAPPER_GENFUNC(RangeMapRead);
WRAPPER_GENFUNC(RangeMapRemove);
WRAPPER_GENFUNC(RangeMapWrite);
WRAPPER_GENFUNC(RemoveInvalidModuleList);
WRAPPER_GENFUNC(ReportSymbolLoadSummary);
WRAPPER_GENFUNC(SearchTreeForFile);
WRAPPER_GENFUNC(SearchTreeForFileW);
WRAPPER_GENFUNC(SetCheckUserInterruptShared);
WRAPPER_GENFUNC(SetSymLoadError);
WRAPPER_GENFUNC(srcfiles);
WRAPPER_GENFUNC(stack_force_ebp);
WRAPPER_GENFUNC(stackdbg);
WRAPPER_GENFUNC(StackWalk);
WRAPPER_GENFUNC(StackWalk2);
WRAPPER_GENFUNC(StackWalk64);
WRAPPER_GENFUNC(StackWalkEx);
WRAPPER_GENFUNC(sym);
WRAPPER_GENFUNC(SymAddrIncludeInlineTrace);
WRAPPER_GENFUNC(SymAddSourceStream);
WRAPPER_GENFUNC(SymAddSourceStreamA);
WRAPPER_GENFUNC(SymAddSourceStreamW);
WRAPPER_GENFUNC(SymAddSymbol);
WRAPPER_GENFUNC(SymAddSymbolW);
WRAPPER_GENFUNC(SymAllocDiaString);
WRAPPER_GENFUNC(SymCleanup);
WRAPPER_GENFUNC(SymCompareInlineTrace);
WRAPPER_GENFUNC(SymDeleteSymbol);
WRAPPER_GENFUNC(SymDeleteSymbolW);
WRAPPER_GENFUNC(SymEnumerateModules);
WRAPPER_GENFUNC(SymEnumerateModules64);
WRAPPER_GENFUNC(SymEnumerateModulesW64);
WRAPPER_GENFUNC(SymEnumerateSymbols);
WRAPPER_GENFUNC(SymEnumerateSymbols64);
WRAPPER_GENFUNC(SymEnumerateSymbolsW);
WRAPPER_GENFUNC(SymEnumerateSymbolsW64);
WRAPPER_GENFUNC(SymEnumLines);
WRAPPER_GENFUNC(SymEnumLinesW);
WRAPPER_GENFUNC(SymEnumProcesses);
WRAPPER_GENFUNC(SymEnumSourceFiles);
WRAPPER_GENFUNC(SymEnumSourceFilesW);
WRAPPER_GENFUNC(SymEnumSourceFileTokens);
WRAPPER_GENFUNC(SymEnumSourceLines);
WRAPPER_GENFUNC(SymEnumSourceLinesW);
WRAPPER_GENFUNC(SymEnumSym);
WRAPPER_GENFUNC(SymEnumSymbols);
WRAPPER_GENFUNC(SymEnumSymbolsEx);
WRAPPER_GENFUNC(SymEnumSymbolsExW);
WRAPPER_GENFUNC(SymEnumSymbolsForAddr);
WRAPPER_GENFUNC(SymEnumSymbolsForAddrW);
WRAPPER_GENFUNC(SymEnumSymbolsW);
WRAPPER_GENFUNC(SymEnumTypes);
WRAPPER_GENFUNC(SymEnumTypesByName);
WRAPPER_GENFUNC(SymEnumTypesByNameW);
WRAPPER_GENFUNC(SymEnumTypesW);
WRAPPER_GENFUNC(SymFindDebugInfoFile);
WRAPPER_GENFUNC(SymFindDebugInfoFileW);
WRAPPER_GENFUNC(SymFindExecutableImage);
WRAPPER_GENFUNC(SymFindExecutableImageW);
WRAPPER_GENFUNC(SymFindFileInPath);
WRAPPER_GENFUNC(SymFindFileInPathW);
WRAPPER_GENFUNC(SymFreeDiaString);
WRAPPER_GENFUNC(SymFromAddr);
WRAPPER_GENFUNC(SymFromAddrW);
WRAPPER_GENFUNC(SymFromIndex);
WRAPPER_GENFUNC(SymFromIndexW);
WRAPPER_GENFUNC(SymFromInlineContext);
WRAPPER_GENFUNC(SymFromInlineContextW);
WRAPPER_GENFUNC(SymFromName);
WRAPPER_GENFUNC(SymFromNameW);
WRAPPER_GENFUNC(SymFromToken);
WRAPPER_GENFUNC(SymFromTokenW);
WRAPPER_GENFUNC(SymFunctionTableAccess);
WRAPPER_GENFUNC(SymFunctionTableAccess64);
WRAPPER_GENFUNC(SymFunctionTableAccess64AccessRoutines);
WRAPPER_GENFUNC(SymGetDiaSession);
WRAPPER_GENFUNC(SymGetDiaSource);
WRAPPER_GENFUNC(SymGetExtendedOption);
WRAPPER_GENFUNC(SymGetFileLineOffsets64);
WRAPPER_GENFUNC(SymGetHomeDirectory);
WRAPPER_GENFUNC(SymGetHomeDirectoryW);
WRAPPER_GENFUNC(SymGetLineFromAddr);
WRAPPER_GENFUNC(SymGetLineFromAddr64);
WRAPPER_GENFUNC(SymGetLineFromAddrW64);
WRAPPER_GENFUNC(SymGetLineFromInlineContext);
WRAPPER_GENFUNC(SymGetLineFromInlineContextW);
WRAPPER_GENFUNC(SymGetLineFromName);
WRAPPER_GENFUNC(SymGetLineFromName64);
WRAPPER_GENFUNC(SymGetLineFromNameW64);
WRAPPER_GENFUNC(SymGetLineNext);
WRAPPER_GENFUNC(SymGetLineNext64);
WRAPPER_GENFUNC(SymGetLineNextW64);
WRAPPER_GENFUNC(SymGetLinePrev);
WRAPPER_GENFUNC(SymGetLinePrev64);
WRAPPER_GENFUNC(SymGetLinePrevW64);
WRAPPER_GENFUNC(SymGetModuleBase);
WRAPPER_GENFUNC(SymGetModuleBase64);
WRAPPER_GENFUNC(SymGetModuleInfo);
WRAPPER_GENFUNC(SymGetModuleInfo64);
WRAPPER_GENFUNC(SymGetModuleInfoW);
WRAPPER_GENFUNC(SymGetModuleInfoW64);
WRAPPER_GENFUNC(SymGetOmapBlockBase);
WRAPPER_GENFUNC(SymGetOmaps);
WRAPPER_GENFUNC(SymGetOptions);
WRAPPER_GENFUNC(SymGetScope);
WRAPPER_GENFUNC(SymGetScopeW);
WRAPPER_GENFUNC(SymGetSearchPath);
WRAPPER_GENFUNC(SymGetSearchPathW);
WRAPPER_GENFUNC(SymGetSourceFile);
WRAPPER_GENFUNC(SymGetSourceFileChecksum);
WRAPPER_GENFUNC(SymGetSourceFileChecksumW);
WRAPPER_GENFUNC(SymGetSourceFileFromToken);
WRAPPER_GENFUNC(SymGetSourceFileFromTokenByTokenName);
WRAPPER_GENFUNC(SymGetSourceFileFromTokenByTokenNameW);
WRAPPER_GENFUNC(SymGetSourceFileFromTokenW);
WRAPPER_GENFUNC(SymGetSourceFileToken);
WRAPPER_GENFUNC(SymGetSourceFileTokenByTokenName);
WRAPPER_GENFUNC(SymGetSourceFileTokenByTokenNameW);
WRAPPER_GENFUNC(SymGetSourceFileTokenW);
WRAPPER_GENFUNC(SymGetSourceFileW);
WRAPPER_GENFUNC(SymGetSourceVarFromToken);
WRAPPER_GENFUNC(SymGetSourceVarFromTokenW);
WRAPPER_GENFUNC(SymGetSymbolFile);
WRAPPER_GENFUNC(SymGetSymbolFileW);
WRAPPER_GENFUNC(SymGetSymFromAddr);
WRAPPER_GENFUNC(SymGetSymFromAddr64);
WRAPPER_GENFUNC(SymGetSymFromName);
WRAPPER_GENFUNC(SymGetSymFromName64);
WRAPPER_GENFUNC(SymGetSymNext);
WRAPPER_GENFUNC(SymGetSymNext64);
WRAPPER_GENFUNC(SymGetSymPrev);
WRAPPER_GENFUNC(SymGetSymPrev64);
WRAPPER_GENFUNC(SymGetTypeFromName);
WRAPPER_GENFUNC(SymGetTypeFromNameW);
WRAPPER_GENFUNC(SymGetTypeInfo);
WRAPPER_GENFUNC(SymGetTypeInfoEx);
WRAPPER_GENFUNC(SymGetUnwindInfo);
WRAPPER_GENFUNC(SymInitialize);
WRAPPER_GENFUNC(SymInitializeW);
WRAPPER_GENFUNC(SymLoadModule);
WRAPPER_GENFUNC(SymLoadModule64);
WRAPPER_GENFUNC(SymLoadModuleEx);
WRAPPER_GENFUNC(SymLoadModuleExW);
WRAPPER_GENFUNC(SymMatchFileName);
WRAPPER_GENFUNC(SymMatchFileNameW);
WRAPPER_GENFUNC(SymMatchString);
WRAPPER_GENFUNC(SymMatchStringA);
WRAPPER_GENFUNC(SymMatchStringW);
WRAPPER_GENFUNC(SymNext);
WRAPPER_GENFUNC(SymNextW);
WRAPPER_GENFUNC(SymPrev);
WRAPPER_GENFUNC(SymPrevW);
WRAPPER_GENFUNC(SymQueryInlineTrace);
WRAPPER_GENFUNC(SymRefreshModuleList);
WRAPPER_GENFUNC(SymRegisterCallback);
WRAPPER_GENFUNC(SymRegisterCallback64);
WRAPPER_GENFUNC(SymRegisterCallbackW64);
WRAPPER_GENFUNC(SymRegisterFunctionEntryCallback);
WRAPPER_GENFUNC(SymRegisterFunctionEntryCallback64);
WRAPPER_GENFUNC(SymRegisterGetSourcePathPartCallback);
WRAPPER_GENFUNC(SymRegisterSourceFileUrlListCallback);
WRAPPER_GENFUNC(SymSearch);
WRAPPER_GENFUNC(SymSearchW);
WRAPPER_GENFUNC(SymSetContext);
WRAPPER_GENFUNC(SymSetDiaSession);
WRAPPER_GENFUNC(SymSetExtendedOption);
WRAPPER_GENFUNC(SymSetHomeDirectory);
WRAPPER_GENFUNC(SymSetHomeDirectoryW);
WRAPPER_GENFUNC(SymSetOptions);
WRAPPER_GENFUNC(SymSetParentWindow);
WRAPPER_GENFUNC(SymSetScopeFromAddr);
WRAPPER_GENFUNC(SymSetScopeFromIndex);
WRAPPER_GENFUNC(SymSetScopeFromInlineContext);
WRAPPER_GENFUNC(SymSetSearchPath);
WRAPPER_GENFUNC(SymSetSearchPathW);
WRAPPER_GENFUNC(SymSetServiceManager);
WRAPPER_GENFUNC(symsrv);
WRAPPER_GENFUNC(SymSrvDeltaName);
WRAPPER_GENFUNC(SymSrvDeltaNameW);
WRAPPER_GENFUNC(SymSrvGetFileIndexes);
WRAPPER_GENFUNC(SymSrvGetFileIndexesW);
WRAPPER_GENFUNC(SymSrvGetFileIndexInfo);
WRAPPER_GENFUNC(SymSrvGetFileIndexInfoW);
WRAPPER_GENFUNC(SymSrvGetFileIndexString);
WRAPPER_GENFUNC(SymSrvGetFileIndexStringW);
WRAPPER_GENFUNC(SymSrvGetSupplement);
WRAPPER_GENFUNC(SymSrvGetSupplementW);
WRAPPER_GENFUNC(SymSrvIsStore);
WRAPPER_GENFUNC(SymSrvIsStoreW);
WRAPPER_GENFUNC(SymSrvStoreFile);
WRAPPER_GENFUNC(SymSrvStoreFileW);
WRAPPER_GENFUNC(SymSrvStoreSupplement);
WRAPPER_GENFUNC(SymSrvStoreSupplementW);
WRAPPER_GENFUNC(SymUnDName);
WRAPPER_GENFUNC(SymUnDName64);
WRAPPER_GENFUNC(SymUnloadModule);
WRAPPER_GENFUNC(SymUnloadModule64);
WRAPPER_GENFUNC(UnDecorateSymbolName);
WRAPPER_GENFUNC(UnDecorateSymbolNameW);
WRAPPER_GENFUNC(UnmapDebugInformation);
WRAPPER_GENFUNC(vc7fpo);
WRAPPER_GENFUNC(WinDbgExtensionDllInit);


void load_version() {
	char systemPath[MAX_PATH];
	GetSystemDirectoryA(systemPath, MAX_PATH);
	strcat_s(systemPath, "\\dbghelp.dll");
	dbghelp_dll = LoadLibraryA(systemPath);

	if (!dbghelp_dll) return;
	
	WRAPPER_FUNC(_EFN_DumpImage);
	WRAPPER_FUNC(block);
	WRAPPER_FUNC(chksym);
	WRAPPER_FUNC(dbghelp);
	WRAPPER_FUNC(DbgHelpCreateUserDump);
	WRAPPER_FUNC(DbgHelpCreateUserDumpW);
	WRAPPER_FUNC(dh);
	WRAPPER_FUNC(EnumDirTree);
	WRAPPER_FUNC(EnumDirTreeW);
	WRAPPER_FUNC(EnumerateLoadedModules);
	WRAPPER_FUNC(EnumerateLoadedModules64);
	WRAPPER_FUNC(EnumerateLoadedModulesEx);
	WRAPPER_FUNC(EnumerateLoadedModulesExW);
	WRAPPER_FUNC(EnumerateLoadedModulesW64);
	WRAPPER_FUNC(ExtensionApiVersion);
	WRAPPER_FUNC(FindDebugInfoFile);
	WRAPPER_FUNC(FindDebugInfoFileEx);
	WRAPPER_FUNC(FindDebugInfoFileExW);
	WRAPPER_FUNC(FindExecutableImage);
	WRAPPER_FUNC(FindExecutableImageEx);
	WRAPPER_FUNC(FindExecutableImageExW);
	WRAPPER_FUNC(FindFileInPath);
	WRAPPER_FUNC(FindFileInSearchPath);
	WRAPPER_FUNC(fptr);
	WRAPPER_FUNC(GetSymLoadError);
	WRAPPER_FUNC(GetTimestampForLoadedLibrary);
	WRAPPER_FUNC(homedir);
	WRAPPER_FUNC(ImageDirectoryEntryToData);
	WRAPPER_FUNC(ImageDirectoryEntryToDataEx);
	WRAPPER_FUNC(ImagehlpApiVersion);
	WRAPPER_FUNC(ImagehlpApiVersionEx);
	WRAPPER_FUNC(ImageNtHeader);
	WRAPPER_FUNC(ImageRvaToSection);
	WRAPPER_FUNC(ImageRvaToVa);
	WRAPPER_FUNC(inlinedbg);
	WRAPPER_FUNC(itoldyouso);
	WRAPPER_FUNC(lmi);
	WRAPPER_FUNC(lminfo);
	WRAPPER_FUNC(MakeSureDirectoryPathExists);
	WRAPPER_FUNC(MapDebugInformation);
	WRAPPER_FUNC(MiniDumpReadDumpStream);
	WRAPPER_FUNC(MiniDumpWriteDump);
	WRAPPER_FUNC(omap);
	WRAPPER_FUNC(optdbgdump);
	WRAPPER_FUNC(optdbgdumpaddr);
	WRAPPER_FUNC(RangeMapAddPeImageSections);
	WRAPPER_FUNC(RangeMapCreate);
	WRAPPER_FUNC(RangeMapFree);
	WRAPPER_FUNC(RangeMapRead);
	WRAPPER_FUNC(RangeMapRemove);
	WRAPPER_FUNC(RangeMapWrite);
	WRAPPER_FUNC(RemoveInvalidModuleList);
	WRAPPER_FUNC(ReportSymbolLoadSummary);
	WRAPPER_FUNC(SearchTreeForFile);
	WRAPPER_FUNC(SearchTreeForFileW);
	WRAPPER_FUNC(SetCheckUserInterruptShared);
	WRAPPER_FUNC(SetSymLoadError);
	WRAPPER_FUNC(srcfiles);
	WRAPPER_FUNC(stack_force_ebp);
	WRAPPER_FUNC(stackdbg);
	WRAPPER_FUNC(StackWalk);
	WRAPPER_FUNC(StackWalk2);
	WRAPPER_FUNC(StackWalk64);
	WRAPPER_FUNC(StackWalkEx);
	WRAPPER_FUNC(sym);
	WRAPPER_FUNC(SymAddrIncludeInlineTrace);
	WRAPPER_FUNC(SymAddSourceStream);
	WRAPPER_FUNC(SymAddSourceStreamA);
	WRAPPER_FUNC(SymAddSourceStreamW);
	WRAPPER_FUNC(SymAddSymbol);
	WRAPPER_FUNC(SymAddSymbolW);
	WRAPPER_FUNC(SymAllocDiaString);
	WRAPPER_FUNC(SymCleanup);
	WRAPPER_FUNC(SymCompareInlineTrace);
	WRAPPER_FUNC(SymDeleteSymbol);
	WRAPPER_FUNC(SymDeleteSymbolW);
	WRAPPER_FUNC(SymEnumerateModules);
	WRAPPER_FUNC(SymEnumerateModules64);
	WRAPPER_FUNC(SymEnumerateModulesW64);
	WRAPPER_FUNC(SymEnumerateSymbols);
	WRAPPER_FUNC(SymEnumerateSymbols64);
	WRAPPER_FUNC(SymEnumerateSymbolsW);
	WRAPPER_FUNC(SymEnumerateSymbolsW64);
	WRAPPER_FUNC(SymEnumLines);
	WRAPPER_FUNC(SymEnumLinesW);
	WRAPPER_FUNC(SymEnumProcesses);
	WRAPPER_FUNC(SymEnumSourceFiles);
	WRAPPER_FUNC(SymEnumSourceFilesW);
	WRAPPER_FUNC(SymEnumSourceFileTokens);
	WRAPPER_FUNC(SymEnumSourceLines);
	WRAPPER_FUNC(SymEnumSourceLinesW);
	WRAPPER_FUNC(SymEnumSym);
	WRAPPER_FUNC(SymEnumSymbols);
	WRAPPER_FUNC(SymEnumSymbolsEx);
	WRAPPER_FUNC(SymEnumSymbolsExW);
	WRAPPER_FUNC(SymEnumSymbolsForAddr);
	WRAPPER_FUNC(SymEnumSymbolsForAddrW);
	WRAPPER_FUNC(SymEnumSymbolsW);
	WRAPPER_FUNC(SymEnumTypes);
	WRAPPER_FUNC(SymEnumTypesByName);
	WRAPPER_FUNC(SymEnumTypesByNameW);
	WRAPPER_FUNC(SymEnumTypesW);
	WRAPPER_FUNC(SymFindDebugInfoFile);
	WRAPPER_FUNC(SymFindDebugInfoFileW);
	WRAPPER_FUNC(SymFindExecutableImage);
	WRAPPER_FUNC(SymFindExecutableImageW);
	WRAPPER_FUNC(SymFindFileInPath);
	WRAPPER_FUNC(SymFindFileInPathW);
	WRAPPER_FUNC(SymFreeDiaString);
	WRAPPER_FUNC(SymFromAddr);
	WRAPPER_FUNC(SymFromAddrW);
	WRAPPER_FUNC(SymFromIndex);
	WRAPPER_FUNC(SymFromIndexW);
	WRAPPER_FUNC(SymFromInlineContext);
	WRAPPER_FUNC(SymFromInlineContextW);
	WRAPPER_FUNC(SymFromName);
	WRAPPER_FUNC(SymFromNameW);
	WRAPPER_FUNC(SymFromToken);
	WRAPPER_FUNC(SymFromTokenW);
	WRAPPER_FUNC(SymFunctionTableAccess);
	WRAPPER_FUNC(SymFunctionTableAccess64);
	WRAPPER_FUNC(SymFunctionTableAccess64AccessRoutines);
	WRAPPER_FUNC(SymGetDiaSession);
	WRAPPER_FUNC(SymGetDiaSource);
	WRAPPER_FUNC(SymGetExtendedOption);
	WRAPPER_FUNC(SymGetFileLineOffsets64);
	WRAPPER_FUNC(SymGetHomeDirectory);
	WRAPPER_FUNC(SymGetHomeDirectoryW);
	WRAPPER_FUNC(SymGetLineFromAddr);
	WRAPPER_FUNC(SymGetLineFromAddr64);
	WRAPPER_FUNC(SymGetLineFromAddrW64);
	WRAPPER_FUNC(SymGetLineFromInlineContext);
	WRAPPER_FUNC(SymGetLineFromInlineContextW);
	WRAPPER_FUNC(SymGetLineFromName);
	WRAPPER_FUNC(SymGetLineFromName64);
	WRAPPER_FUNC(SymGetLineFromNameW64);
	WRAPPER_FUNC(SymGetLineNext);
	WRAPPER_FUNC(SymGetLineNext64);
	WRAPPER_FUNC(SymGetLineNextW64);
	WRAPPER_FUNC(SymGetLinePrev);
	WRAPPER_FUNC(SymGetLinePrev64);
	WRAPPER_FUNC(SymGetLinePrevW64);
	WRAPPER_FUNC(SymGetModuleBase);
	WRAPPER_FUNC(SymGetModuleBase64);
	WRAPPER_FUNC(SymGetModuleInfo);
	WRAPPER_FUNC(SymGetModuleInfo64);
	WRAPPER_FUNC(SymGetModuleInfoW);
	WRAPPER_FUNC(SymGetModuleInfoW64);
	WRAPPER_FUNC(SymGetOmapBlockBase);
	WRAPPER_FUNC(SymGetOmaps);
	WRAPPER_FUNC(SymGetOptions);
	WRAPPER_FUNC(SymGetScope);
	WRAPPER_FUNC(SymGetScopeW);
	WRAPPER_FUNC(SymGetSearchPath);
	WRAPPER_FUNC(SymGetSearchPathW);
	WRAPPER_FUNC(SymGetSourceFile);
	WRAPPER_FUNC(SymGetSourceFileChecksum);
	WRAPPER_FUNC(SymGetSourceFileChecksumW);
	WRAPPER_FUNC(SymGetSourceFileFromToken);
	WRAPPER_FUNC(SymGetSourceFileFromTokenByTokenName);
	WRAPPER_FUNC(SymGetSourceFileFromTokenByTokenNameW);
	WRAPPER_FUNC(SymGetSourceFileFromTokenW);
	WRAPPER_FUNC(SymGetSourceFileToken);
	WRAPPER_FUNC(SymGetSourceFileTokenByTokenName);
	WRAPPER_FUNC(SymGetSourceFileTokenByTokenNameW);
	WRAPPER_FUNC(SymGetSourceFileTokenW);
	WRAPPER_FUNC(SymGetSourceFileW);
	WRAPPER_FUNC(SymGetSourceVarFromToken);
	WRAPPER_FUNC(SymGetSourceVarFromTokenW);
	WRAPPER_FUNC(SymGetSymbolFile);
	WRAPPER_FUNC(SymGetSymbolFileW);
	WRAPPER_FUNC(SymGetSymFromAddr);
	WRAPPER_FUNC(SymGetSymFromAddr64);
	WRAPPER_FUNC(SymGetSymFromName);
	WRAPPER_FUNC(SymGetSymFromName64);
	WRAPPER_FUNC(SymGetSymNext);
	WRAPPER_FUNC(SymGetSymNext64);
	WRAPPER_FUNC(SymGetSymPrev);
	WRAPPER_FUNC(SymGetSymPrev64);
	WRAPPER_FUNC(SymGetTypeFromName);
	WRAPPER_FUNC(SymGetTypeFromNameW);
	WRAPPER_FUNC(SymGetTypeInfo);
	WRAPPER_FUNC(SymGetTypeInfoEx);
	WRAPPER_FUNC(SymGetUnwindInfo);
	WRAPPER_FUNC(SymInitialize);
	WRAPPER_FUNC(SymInitializeW);
	WRAPPER_FUNC(SymLoadModule);
	WRAPPER_FUNC(SymLoadModule64);
	WRAPPER_FUNC(SymLoadModuleEx);
	WRAPPER_FUNC(SymLoadModuleExW);
	WRAPPER_FUNC(SymMatchFileName);
	WRAPPER_FUNC(SymMatchFileNameW);
	WRAPPER_FUNC(SymMatchString);
	WRAPPER_FUNC(SymMatchStringA);
	WRAPPER_FUNC(SymMatchStringW);
	WRAPPER_FUNC(SymNext);
	WRAPPER_FUNC(SymNextW);
	WRAPPER_FUNC(SymPrev);
	WRAPPER_FUNC(SymPrevW);
	WRAPPER_FUNC(SymQueryInlineTrace);
	WRAPPER_FUNC(SymRefreshModuleList);
	WRAPPER_FUNC(SymRegisterCallback);
	WRAPPER_FUNC(SymRegisterCallback64);
	WRAPPER_FUNC(SymRegisterCallbackW64);
	WRAPPER_FUNC(SymRegisterFunctionEntryCallback);
	WRAPPER_FUNC(SymRegisterFunctionEntryCallback64);
	WRAPPER_FUNC(SymRegisterGetSourcePathPartCallback);
	WRAPPER_FUNC(SymRegisterSourceFileUrlListCallback);
	WRAPPER_FUNC(SymSearch);
	WRAPPER_FUNC(SymSearchW);
	WRAPPER_FUNC(SymSetContext);
	WRAPPER_FUNC(SymSetDiaSession);
	WRAPPER_FUNC(SymSetExtendedOption);
	WRAPPER_FUNC(SymSetHomeDirectory);
	WRAPPER_FUNC(SymSetHomeDirectoryW);
	WRAPPER_FUNC(SymSetOptions);
	WRAPPER_FUNC(SymSetParentWindow);
	WRAPPER_FUNC(SymSetScopeFromAddr);
	WRAPPER_FUNC(SymSetScopeFromIndex);
	WRAPPER_FUNC(SymSetScopeFromInlineContext);
	WRAPPER_FUNC(SymSetSearchPath);
	WRAPPER_FUNC(SymSetSearchPathW);
	WRAPPER_FUNC(SymSetServiceManager);
	WRAPPER_FUNC(symsrv);
	WRAPPER_FUNC(SymSrvDeltaName);
	WRAPPER_FUNC(SymSrvDeltaNameW);
	WRAPPER_FUNC(SymSrvGetFileIndexes);
	WRAPPER_FUNC(SymSrvGetFileIndexesW);
	WRAPPER_FUNC(SymSrvGetFileIndexInfo);
	WRAPPER_FUNC(SymSrvGetFileIndexInfoW);
	WRAPPER_FUNC(SymSrvGetFileIndexString);
	WRAPPER_FUNC(SymSrvGetFileIndexStringW);
	WRAPPER_FUNC(SymSrvGetSupplement);
	WRAPPER_FUNC(SymSrvGetSupplementW);
	WRAPPER_FUNC(SymSrvIsStore);
	WRAPPER_FUNC(SymSrvIsStoreW);
	WRAPPER_FUNC(SymSrvStoreFile);
	WRAPPER_FUNC(SymSrvStoreFileW);
	WRAPPER_FUNC(SymSrvStoreSupplement);
	WRAPPER_FUNC(SymSrvStoreSupplementW);
	WRAPPER_FUNC(SymUnDName);
	WRAPPER_FUNC(SymUnDName64);
	WRAPPER_FUNC(SymUnloadModule);
	WRAPPER_FUNC(SymUnloadModule64);
	WRAPPER_FUNC(UnDecorateSymbolName);
	WRAPPER_FUNC(UnDecorateSymbolNameW);
	WRAPPER_FUNC(UnmapDebugInformation);
	WRAPPER_FUNC(vc7fpo);
	WRAPPER_FUNC(WinDbgExtensionDllInit);

}

DWORD WINAPI Load(LPVOID lpParam) {
	load_version();
	if (!dbghelp_dll)
		return 0;

#ifdef _DEBUG
	MessageBox(NULL, L"It's working!", L"version proxy", MB_OK | MB_ICONINFORMATION | MB_SYSTEMMODAL);
#endif

	// your payload goes here

	return 0;
}
